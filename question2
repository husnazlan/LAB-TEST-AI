import streamlit as st

st.title("Smart Home AC Controller")

# Input fields
temperature = st.number_input("Temperature (°C)", value=22)
humidity = st.number_input("Humidity (%)", value=46)
occupancy = st.selectbox("Occupancy", ["OCCUPIED", "EMPTY"])
time_of_day = st.selectbox("Time of Day", ["MORNING", "AFTERNOON", "EVENING", "NIGHT"])
windows_open = st.selectbox("Windows Open?", [True, False])

if st.button("Decide AC Settings"):
    # Rule: Windows open → OFF
    if windows_open == True:
        mode = "OFF"
        fan = "LOW"
        setpoint = "-"
        reason = "Windows are open"
    
    # Rule: No one home → ECO
    elif occupancy == "EMPTY" and temperature >= 24:
        mode = "ECO"
        fan = "LOW"
        setpoint = "27°C"
        reason = "Home empty; save energy"
    
    # Rule: Too cold → OFF
    elif temperature <= 22:
        mode = "OFF"
        fan = "LOW"
        setpoint = "-"
        reason = "Already cold"
    
    # Rule: Hot & humid → strong cool
    elif occupancy == "OCCUPIED" and temperature >= 30 and humidity >= 70:
        mode = "COOL"
        fan = "HIGH"
        setpoint = "23°C"
        reason = "Hot and humid"
    
    # Rule: Night sleep mode
    elif occupancy == "OCCUPIED" and time_of_day == "NIGHT" and temperature >= 26:
        mode = "SLEEP"
        fan = "LOW"
        setpoint = "26°C"
        reason = "Night comfort"
    
    # Rule: Hot → cooling
    elif occupancy == "OCCUPIED" and temperature >= 28:
        mode = "COOL"
        fan = "MEDIUM"
        setpoint = "24°C"
        reason = "Temperature high"
    
    # Rule: Slightly warm → gentle cool
    elif occupancy == "OCCUPIED" and 26 <= temperature < 28:
        mode = "COOL"
        fan = "LOW"
        setpoint = "25°C"
        reason = "Slightly warm"
    
    else:
        mode = "NO ACTION"
        fan = "-"
        setpoint = "-"
        reason = "No rules matched"

    st.subheader("AC Decision")
    st.write("AC Mode:", mode)
    st.write("Fan Speed:", fan)
    st.write("Setpoint:", setpoint)
    st.write("Reason:", reason)
